jquery_image_gallery_backend_script=function(){var i=jQuery,e={};return e.isBackendInitialized=!1,e.init=function(){e.isBackendInitialized||(e.isBackendInitialized=!0,i(document).trigger("galleryBackendReady"))},i(document).ready(e.init),i(window).load(e.init),e}();
jquery_image_gallery_backend_script.editGallery=function(){var e=jQuery,a={};return a.uploader=null,a.init=function(){"gp_gallery"===window.pagenow&&(a.isCurrentPage=!0,a.$imagesMetaBox=e("#images"),a.$imagesGrid=a.$imagesMetaBox.find(".images-grid"),a.$imageTemplate=a.$imagesMetaBox.find(".image-template"),a.activateUploader(),a.activate())},a.activateUploader=function(){e(".images-insert-button").on("click",function(e){e.preventDefault();var t,i;return a.uploader?(a.uploader.open(),void 0):(i=window.jquery_image_gallery_backend_script_editGallery,t="Insert images","object"==typeof i&&"object"==typeof i.localization&&void 0!==i.localization.uploaderTitle&&i.localization.uploaderTitle.length>0&&(t=i.localization.uploaderTitle),a.uploader=wp.media.frames.jquery_image_galler_uploader=wp.media({frame:"select",title:t,multiple:!0,library:{type:"image"}}),a.uploader.on("select",function(){var e,t,i=a.uploader.state().get("selection").toJSON();for(t in i)i.hasOwnProperty(t)&&(e=i[t],a.insertImage(e.id,e.title,e.description,e.url,e.alt))}),a.uploader.open(),void 0)})},a.activate=function(){a.indexImageOrder(),a.$imagesGrid.sortable({revert:!0,placeholder:"sortable-placeholder",forcePlaceholderSize:!0,stop:function(){a.indexImageOrder()},cancel:"input, select, textarea, span"}),a.$imagesGrid.find(".image-delete-button").click(function(t){a.deleteImage(e(t.currentTarget).closest(".image"))})},a.deleteImage=function(e){var a="Are you sure you want to delete this image?",t=window.jquery_image_gallery_backend_script_editGallery;"object"==typeof t&&"object"==typeof t.localization&&void 0!==t.localization.confirm&&t.localization.confirm.length>0&&(a=t.localization.confirm),confirm(a)&&e.remove()},a.indexImageOrder=function(){a.$imagesGrid.find(".image").each(function(a,t){e.each(e(t).find("input, select, textarea"),function(t,i){var n=e(i),r=n.attr("name");void 0===r||r.length<=0||(r=r.replace(/[\[\]']+/g," ").split(" "),n.attr("name",r[0]+"["+(a+1)+"]["+r[2]+"]"))})})},a.insertImage=function(e,t,i,n,r){var l=a.$imageTemplate.find(".image").clone(!0,!0);l.find(".image-thumbnail").attr("src",n),l.find(".image-thumbnail").attr("title",t),l.find(".image-thumbnail").attr("alt",r),l.find(".title").attr("value",t),l.find(".alternativeText").attr("value",r),l.find(".postID").attr("value",e),l.find(".title").attr("name","_images[0][title]"),l.find(".alternativeText").attr("name","_images[0][alternativeText]"),l.find(".postID").attr("name","_images[0][postID]"),a.$imagesGrid.prepend(l),a.indexImageOrder()},e(document).bind("galleryBackendReady",a.init),a}();